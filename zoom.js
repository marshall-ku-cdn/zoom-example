window.Zoom=function(e,t){const r=t&&t.originalizer?t.originalizer:e=>e,n={screenWidth:0,screenHeight:0,scrollBar:0},o=t&&t.background?t.background:null,s=()=>{const{documentElement:e}=document;n.screenWidth=window.innerWidth||e.clientWidth,n.screenHeight=window.innerHeight||e.clientHeight,n.scrollBar=n.screenWidth-e.offsetWidth},c=e=>{(e=>{const t=e.currentSrc||e.src,{srcset:s}=e,{screenWidth:c,screenHeight:a,scrollBar:l}=n,d=e.getBoundingClientRect(),{width:g,height:m,left:h,top:u}=d,f=(c-l)/2-h-g/2,w=(a-m)/2-u,y=document.createElement("div"),p=document.createElement("div"),v=document.createElement("img");let b=e.naturalWidth;if(p.style.top=`${u+window.scrollY}px`,p.style.left=`${h}px`,p.style.width=`${g}px`,p.style.height=`${m}px`,document.body.append(y),document.body.append(p),y.classList.add("zoom__bg"),o)if("auto"===o){const t=i(e);y.style.background=t?`rgb(${t.r}, ${t.g}, ${t.b})`:"rgb(0, 0, 0)"}else y.style.background=o;p.classList.add("zoom"),p.append(v);const E=/ ([0-9]+)w/gm;if(s){const e=s.match(E);e&&e.forEach(e=>{const t=+e.trim().replace("w","");t>b&&(b=t)})}b>=c&&(b=c);const L=b*(m/g);L>=a&&(b=b*a/L),v.classList.add("zoom__img"),v.src=t,v.srcset=s,v.width=g,v.height=m,setTimeout(()=>{const n=r(t);e.style.opacity="0",p.style.transform=`translate3d(${f}px, ${w}px, 0)`,y.classList.add("zoom__bg--reveal"),b!==g&&(v.style.transform=`scale(${b/g})`),m>a&&(v.style.transform=`scale(${a/m})`),v.src=n,v.srcset=""},30);const $=()=>{p.classList.add("zoom--removing"),y.classList.remove("zoom__bg--reveal"),p.style.transform="",v.removeAttribute("style"),setTimeout(()=>{y.remove(),p.remove(),e.style.opacity=""},300),window.removeEventListener("scroll",$)};p.addEventListener("click",$,{once:!0}),window.addEventListener("scroll",$,{once:!0})})(e.target)},i=e=>{const t={r:0,g:0,b:0},r=document.createElement("canvas"),n=r.getContext("2d");if(!n)return null;const o=r.width=e.naturalWidth||e.offsetWidth||e.width,s=r.height=e.naturalHeight||e.offsetHeight||e.height;let c,i,a=-4,l=0;n.drawImage(e,0,0);try{c=n.getImageData(0,0,o,s)}catch(e){return null}for(i=c.data.length;(a+=20)<i;)++l,t.r+=c.data[a],t.g+=c.data[a+1],t.b+=c.data[a+2];return t.r=Math.floor(t.r/l),t.g=Math.floor(t.g/l),t.b=Math.floor(t.b/l),t};s(),window.addEventListener("resize",s,{passive:!0}),document.querySelectorAll(e).forEach(e=>{if("IMG"===e.tagName)e.addEventListener("click",c);else{const t=e.querySelector("img");t&&t.addEventListener("click",c)}})};!function(){const e=document.createElement("style"),t=document.head||document.getElementsByTagName("head")[0];e.appendChild(document.createTextNode(".zoom{position:absolute;top:0;left:0;width:100%;height:100%;transition:transform .3s ease-in-out;z-index:90000;cursor:zoom-out}.zoom>.zoom__img{position:relative;z-index:2;transition:transform .3s ease-in-out;cursor:zoom-out}.zoom.zoom--removing>img{z-index:1}.zoom__bg{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#121212;opacity:0;transition:opacity .3s ease-in-out}.zoom__bg.zoom__bg--reveal{opacity:.95}")),t.appendChild(e)}();
